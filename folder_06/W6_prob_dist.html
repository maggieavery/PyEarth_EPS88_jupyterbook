

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>6.1 Probability Distributions &#8212; Python Intro to Geoscience</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/mystnb.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.2 Examples of Random Earth Processes" href="W6_random_earth.html" />
    <link rel="prev" title="Chapter 6: Probability Distributions and Random Earth Processes" href="../week_06.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Python Intro to Geoscience</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to PyEarth
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../week_01.html">
   Chapter 1: Introduction to Jupyter Notebooks and Map Projections
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_02.html">
   Chapter 2: Data Input and Our Dynamic Earth
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_03.html">
   Chapter 3: Data Visualization and Earthquakes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_04.html">
   Chapter 4: Data Wrangling, Functions, and Seafloor Spreading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_05.html">
   Chapter 5: Loops and Earthquake Statistics
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="../week_06.html">
   Chapter 6: Probability Distributions and Random Earth Processes
  </a>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     6.1 Probability Distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="W6_random_earth.html">
     6.2 Examples of Random Earth Processes
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_07.html">
   Chapter 7: A/B Testing and Igneous Geochemistry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_08.html">
   Chapter 8: Bootstrapping, Glaciers, and Directional Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_09.html">
   Chapter 9: Regression and Atmospheric CO
   <span class="math notranslate nohighlight">
    \(_{2}\)
   </span>
   Concentration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../week_10.html">
   Chapter 10: Time Series Analysis and Glacial Cycles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../append_A.html">
   Appendix A: Function Catalog
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/folder_06/W6_prob_dist.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> On this page
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#additional-assigned-reading">
   Additional Assigned Reading
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#flipping-a-coin">
   Flipping a coin
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-statistical-concepts">
   Basic statistical concepts
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Probability Distributions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#binomial-distribution">
     Binomial Distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#poisson-distribution">
     Poisson Distribution
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gamma-distribution">
     Gamma Distribution
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="probability-distributions">
<h1>6.1 Probability Distributions<a class="headerlink" href="#probability-distributions" title="Permalink to this headline">¶</a></h1>
<p><strong>Outline:</strong></p>
<ul class="simple">
<li><p>Introduction to probability distributions and empirical distributions</p></li>
<li><p>Bionomial, Poisson, and Gamma distributions for random events</p></li>
</ul>
<div class="section" id="additional-assigned-reading">
<h2>Additional Assigned Reading<a class="headerlink" href="#additional-assigned-reading" title="Permalink to this headline">¶</a></h2>
<p>Data 8 textbook “Computational and Inferential Thinking: The Foundations of Data Science” By Ani Adhikari and John DeNero <a class="reference external" href="https://www.inferentialthinking.com/chapters/10/Sampling_and_Empirical_Distributions.html">Chapter 10 Sampling and Empirical Distributions</a>. This should overlap with your assigned reading for Data 8.</p>
</div>
<div class="section" id="flipping-a-coin">
<h2>Flipping a coin<a class="headerlink" href="#flipping-a-coin" title="Permalink to this headline">¶</a></h2>
<p>Let’s pretend we are flipping a coin 10 times using <code class="docutils literal notranslate"><span class="pre">np.random.choice([0,</span> <span class="pre">1])</span></code>. How many times will be heads? 1 is heads, 0 is tails. Let’s use a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop and get Python to simulate such a coin flip scenario for us.</p>
<p>The code will get looped through 10 times – specified by <code class="docutils literal notranslate"><span class="pre">range(0,10)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="k">as</span> <span class="nn">scipy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="k">for</span> <span class="n">flip</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">flip_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">flip_result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>1
1
0
0
1
0
1
1
0
0
</pre></div>
</div>
</div>
</div>
<p>Now let’s record how many times the result was heads. We will make a list called <code class="docutils literal notranslate"><span class="pre">flip_results</span></code> and have it be blank to start. Each time we go through the code we will append the result to the list:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">flip_results</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">flip</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">flip_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">flip_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flip_result</span><span class="p">)</span>
    
<span class="n">flip_results</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>[0, 0, 1, 1, 0, 0, 1, 1, 0, 0]
</pre></div>
</div>
</div>
</div>
<p>We can calculate how many times were heads by taking the sum of the list:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">flip_results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>4
</pre></div>
</div>
</div>
</div>
<p>Now we’ll repeat our expirement of 10 flips 10 times keeping a count of the number of heads in each experiment in <code class="docutils literal notranslate"><span class="pre">number_heads</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">number_heads</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">flip_experiment</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>

    <span class="n">flip_results</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">flip</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">flip_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">flip_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flip_result</span><span class="p">)</span>
    
    <span class="n">number_heads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">flip_results</span><span class="p">))</span>   
        
<span class="n">number_heads</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>[8, 5, 6, 6, 7, 5, 6, 4, 7, 5]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">number_heads</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">11.5</span><span class="p">,</span><span class="mf">1.0</span><span class="p">),</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of heads out of 10 attempts, in 10 trials&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/W6_prob_dist_9_0.png" src="../_images/W6_prob_dist_9_0.png" />
</div>
</div>
<p>Instead of doing 10 coin flips 10 times, do 10 coin flips 1000 times. Plot the histogram of the result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">number_heads</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">flip_experiment</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">):</span>

    <span class="n">flip_results</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">flip</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">flip_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">flip_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flip_result</span><span class="p">)</span>
    
    <span class="n">number_heads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">flip_results</span><span class="p">))</span>   
        
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">number_heads</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">11.5</span><span class="p">,</span><span class="mf">1.0</span><span class="p">),</span><span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of heads out of 10 attempts, in 1000 trials&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/W6_prob_dist_11_0.png" src="../_images/W6_prob_dist_11_0.png" />
</div>
</div>
</div>
<div class="section" id="basic-statistical-concepts">
<h2>Basic statistical concepts<a class="headerlink" href="#basic-statistical-concepts" title="Permalink to this headline">¶</a></h2>
<p><em>Statistics</em> are the methods by which we analyze, interpret and model data. It is helpful to understand a few concepts:</p>
<ol class="simple">
<li><p><strong>Population</strong> versus <strong>sample</strong>: the <em>population</em> is the set of all possible outcomes of a given measurement (if you had an infinite number of data points), while the <em>sample</em> is what you have - a finite number of data points.</p></li>
<li><p><strong>Probability</strong>: the measure of how likely it is for a particular event to occur.  If something is impossible, it has a probability <span class="math notranslate nohighlight">\(P\)</span> of 0.  If it is a certainty, it has a probability <span class="math notranslate nohighlight">\(P\)</span> of 1. In our coin flip experiment both heads and tails had equal probabilty of 0.5.</p></li>
<li><p><strong>Theoretical</strong> versus <strong>empirical</strong> distributions: Empirical distributions are measured data. Theoretical distributions are analytical probabililty functions described with an equation.  These can be applied to data, allowing interpretations about the likelihood of observing a given measurement.</p></li>
</ol>
<p>Additional resources: Olea (2008): https://pubs.usgs.gov/of/2008/1017/ofr2008-1017_rev.pdf; Davis, J. (2002): Statistical and Data Analysis in Geology, 3rd Ed, Wiley, Hoboken.</p>
<p>There are many different types of probability distributions and evaluating the equations gives us a theoretical distribution.</p>
<p>Samples are finite collections of observations which belong to a distribution. In this exercise, we will simulate ‘measurements’ by drawing ‘observations’ from a theoretical distribution.  This is the <em>Monte Carlo</em> approach (named after the gambling town).</p>
<p><strong>We just simulated an experiment of flipping a coin. Let’s compare what we got through that simulation to the theoretical distribution.</strong></p>
</div>
<div class="section" id="id1">
<h2>Probability Distributions<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="binomial-distribution">
<h3>Binomial Distribution<a class="headerlink" href="#binomial-distribution" title="Permalink to this headline">¶</a></h3>
<p>A relatively straight-forward distribution is the <em>binomial</em> distribution which describes the probability of a particular outcome when there are only two possibilities (yes or no, heads or tails, 1 or 0).   For example, in a coin toss experiment (heads or tails), if we flip the coin  <span class="math notranslate nohighlight">\(n\)</span> times, what is the probability of getting <span class="math notranslate nohighlight">\(x\)</span> ‘heads’?  We assume that the probability <span class="math notranslate nohighlight">\(p\)</span> of a head for any given coin toss is 50%; put another way <span class="math notranslate nohighlight">\(p\)</span> = 0.5.</p>
<p>The binomial distribution can be described by an equation:</p>
<div class="math notranslate nohighlight">
\[P=f(x,p,n)= \frac{n!}{x!(n-x)!}p^x(1-p)^{n-x}\]</div>
<p>We can look at this kind of distribution by evaluating the probability for getting <span class="math notranslate nohighlight">\(x\)</span> ‘heads’ out of <span class="math notranslate nohighlight">\(n\)</span> attempts. We’ll code the equation as a function, and calculate the probability <span class="math notranslate nohighlight">\(P\)</span> of a particular outcome (e.g., <span class="math notranslate nohighlight">\(x\)</span> heads in <span class="math notranslate nohighlight">\(n\)</span> attempts).</p>
<p>Note that for a coin toss, <span class="math notranslate nohighlight">\(p\)</span> is 0.5, but other yes/no questions can be investigated as well (e.g., chance of finding a fossil in a sedimentary layer, whether or not a landslide occurs following an earthquake).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="o">=</span><span class="mi">10</span> <span class="c1"># number of attempts in each trial</span>
<span class="n">p</span><span class="o">=</span><span class="mf">0.5</span> <span class="c1"># probability of getting a head</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># range of test values from 0,N</span>

<span class="c1"># initialize size of probability array</span>
<span class="n">bi_prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> 

<span class="c1"># compute the binomial probability of getting x outcomes in n attempts</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">bi_prob</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="n">p</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>

<span class="c1">#plot the probability distribution</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">bi_prob</span><span class="p">,</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># plot as solid line</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of heads out of 10 attempts, $\infty$ trials&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span> <span class="c1"># add labels</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Binomial Distribution&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/W6_prob_dist_14_0.png" src="../_images/W6_prob_dist_14_0.png" />
</div>
</div>
<p>Notice how similiar this is to the histogram we made of our 1000 experiments of 10 coin flips. Also notice that with only 10 experiments the empirical histogram of heads does not look much like the theoretical distribution.</p>
</div>
<div class="section" id="poisson-distribution">
<h3>Poisson Distribution<a class="headerlink" href="#poisson-distribution" title="Permalink to this headline">¶</a></h3>
<p>The Poisson distribution gives the probability that an event (with two possible outcomes) occurs <span class="math notranslate nohighlight">\(k\)</span> number of times in an interval of time where <span class="math notranslate nohighlight">\(\lambda\)</span> is the expected rate of occurance. The Poisson distribution is the limit of the binomial distribution for large <span class="math notranslate nohighlight">\(n\)</span>. So if you take the limit of the binomial distribution as <span class="math notranslate nohighlight">\(n \rightarrow \infty\)</span></p>
<div class="math notranslate nohighlight">
\[\lim_{n \rightarrow \infty } \frac{n!}{k!(n-k)!}p^k(1-p)^{n-k} = \frac{n!}{k!(n-k)!}(\frac{\lambda}{n})^k(1-\frac{\lambda}{n})^{n-k} \]</div>
<p>you’ll get the Poisson distribution:</p>
<p><span class="math notranslate nohighlight">\(P(k\)</span> events in interval<span class="math notranslate nohighlight">\() = e^{-\lambda}\frac{\lambda^{k}}{k!}.\)</span></p>
<p>Because <span class="math notranslate nohighlight">\(\lim_{x \rightarrow \infty } (1+\frac{a}{x})^{x}=e^{a}\)</span> and <span class="math notranslate nohighlight">\(\lim_{x \rightarrow \infty } \frac{x!}{x^{k}(x-k)!} = 1\)</span></p>
<p><strong>Watach these two videos explaining Poisson processes, from Khan Academy:</strong></p>
<p><a class="reference external" href="https://www.khanacademy.org/math/statistics-probability/random-variables-stats-library/poisson-distribution/v/poisson-process-1">Poisson Process 1</a></p>
<p><a class="reference external" href="https://www.khanacademy.org/math/statistics-probability/random-variables-stats-library/poisson-distribution/v/poisson-process-2">Poisson Process 2</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lam</span> <span class="o">=</span> <span class="mi">4</span> <span class="c1"># average rate of occurance (e.g. cars per hour)</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># number of times the event actually occurs (e.g. observed cars in an hours)</span>

<span class="c1"># initialize size of probability array</span>
<span class="n">pos_prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">))</span> 

<span class="c1"># compute the binomial probability of getting x outcomes in n attempts</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">pos_prob</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">lam</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">lam</span><span class="o">**</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
<span class="c1"># plot    </span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">pos_prob</span><span class="p">,</span><span class="s1">&#39;ro&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\lambda$ = 4&#39;</span><span class="p">)</span> <span class="c1"># theoretical curve for lam = 4</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$k$, number of events&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability of $k$ events&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Poisson Distribution&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/W6_prob_dist_17_0.png" src="../_images/W6_prob_dist_17_0.png" />
</div>
</div>
</div>
<div class="section" id="gamma-distribution">
<h3>Gamma Distribution<a class="headerlink" href="#gamma-distribution" title="Permalink to this headline">¶</a></h3>
<p>The Gamma distribution gives the probability of a waiting interval between Poisson distributed events (that is an event that randomly occurs but for which is there is an average time period between the events).</p>
<p>Consider the distribution function <span class="math notranslate nohighlight">\(D(x)\)</span> of waiting times until the <span class="math notranslate nohighlight">\(h\)</span>th Poisson event given a Poisson distribution with a rate of occurance <span class="math notranslate nohighlight">\(\lambda\)</span>,</p>
<div class="math notranslate nohighlight">
\[ D(x) = P (X \le x) = 1 - P(X &gt; x) = 1-\sum_{k=0}^{h-1}\frac{(\lambda x)^{k}e^{-\lambda x}}{k!} = 1-e^{-\lambda x}\sum_{k=0}^{h-1}\frac{(\lambda x)^{k}}{k!} = 1-\frac{\Gamma(h,x\lambda) }{\Gamma (h)}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Gamma (x) = (x-1)!\)</span> is a complete gamma function and <span class="math notranslate nohighlight">\(\Gamma (n,x) = (n-1)! e^{-x}\sum_{k=0}^{n-1}\frac{x^{k}}{k!}\)</span> an incomplete gamma function. The corresponding probability function <span class="math notranslate nohighlight">\(P(x)\)</span> of waiting times until the <span class="math notranslate nohighlight">\(h\)</span>th Poisson event is then obtained by differentiating  <span class="math notranslate nohighlight">\(D(x)\)</span>,</p>
<div class="math notranslate nohighlight">
\[ P(x) = D'(x) = \frac{\lambda (\lambda x)^{h-1}}{(h-1)!}e^{-\lambda x} \]</div>
<p>Now let <span class="math notranslate nohighlight">\(\alpha=h\)</span> (not necessarily an integer) and define <span class="math notranslate nohighlight">\(\theta=1/\lambda\)</span> to be the time between occurances. Then the above equation can be written</p>
<div class="math notranslate nohighlight">
\[ P(x) = \frac{x^{\alpha-1}e^{-x/\theta}}{\Gamma (\alpha) \theta^{\alpha}} \]</div>
<p>which is the probability of a duration time <span class="math notranslate nohighlight">\(x\)</span> between events.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># theoretical gamma prob distribution</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.2</span>
<span class="n">avg_dur</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span> <span class="c1"># average wait time (4 cars per hours so 1/4 hour)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">avg_dur</span> <span class="o">/</span> <span class="n">alpha</span><span class="p">;</span>
<span class="n">wait_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.001</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">gamma_prob</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wait_time</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">wait_time</span><span class="p">),</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">gamma_prob</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">wait_time</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="p">(</span><span class="n">alpha</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">wait_time</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">theta</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">scipy</span><span class="o">.</span><span class="n">special</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span><span class="o">*</span> <span class="n">theta</span><span class="o">**</span><span class="n">alpha</span><span class="p">)</span>


<span class="c1"># plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wait_time</span><span class="p">,</span><span class="n">gamma_prob</span><span class="p">,</span><span class="s1">&#39;ro&#39;</span><span class="p">)</span> <span class="c1"># theoretical curve </span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wait time Duration&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Probability of a wait time&#39;</span><span class="p">,</span>  <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Gamma Distribution&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/W6_prob_dist_19_0.png" src="../_images/W6_prob_dist_19_0.png" />
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./folder_06"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../week_06.html" title="previous page">Chapter 6: Probability Distributions and Random Earth Processes</a>
    <a class='right-next' id="next-link" href="W6_random_earth.html" title="next page">6.2 Examples of Random Earth Processes</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By EPS 88 Team<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>